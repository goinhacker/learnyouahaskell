# 사용자 정의 타입 만들기4

## 타입클래스

지난 챕터에서 몇가지 하스켈의 표준 타입클래스들을 배우고, 어떤 타입들이 속하는지 보았습니다. 또한 사용자 정의 타입을 표준 타입클래스로부터 파생시키는 방법을 살펴보았습니다. 이번 섹션에서는 사용자 정의 타입클래스를 만들고, 그것으로부터 파생되는 타입을 만들어 보겠습니다.

그동안 배운 타입클래스에 대한 내용을 요약하면 타입클래스는 인터페이스와 같다는 것입니다. 타입클래스는 동일한지 비교하거나, 순서를 비교하는 등의 몇가지 동작을 정의합니다. 그리고 타입은 타입클래스의 인스턴스로 만듬으로써 해당 동작을 할 수 있습니다. 타입클래스들의 동작은 함수들을 정의하거나 구현한 선언을 입력하여 얻을 수 있습니다. 어떤 타입이 타입클래스의 인스턴스라는 것은 타입이 타입클래스의 동작을 할 수 있다는 것을 의미합니다.

타입클래스는 자바나 파이썬의 클래스와는 전혀 관계가 없습니다. 이 부분이 헷갈리수 있으므로 지금부터는 명령형 언어의 클래스들에 대해서는 완전히 잊어야 합니다!!

예를들어, `Eq` 타입클래스는 동일한지를 확인할 수 있는데 `==`과 `/=` 함수를 정의하고 있습니다. 만약 `Car`라는 타입이 `Eq` 타입클래스의 인스턴스라면, 두개의 차가 동일한지 여부를 `==`함수로 확인할 수 있습니다. 

`Eq` 타입클래스는 표준 prelude 모듈에 아래와 같이 정의되어 있습니다. 

```haskell
class Eq a where
    (==) :: a -> a -> Bool
    (/=) :: a -> a -> Bool
    x == y = not (x /= y)
    x /= y = not (x == y)
```  

여기서 `class Eq a where`는 `Eq`라는 새로운 타입클래스를 정의하는 것을 의미합니다. 여기서 `a`는 타입 변수이고, `Eq`의 인스턴스가 될 타입의 역할을 수행합니다. `a` 다른 이름으로 쓰일 수 있고, 한개의 문자가 아니어도 되지만 소문자로 구성되어야 합니다. 그 다음에는 여러가지 함수들이 정의되었습니다. 여기서 함수의 바디를 구현하는 것은 필수가 아닙니다. 따라서 그냥 함수의 선언만 명시해도 됩니다. 

어쨋든 여기는 `Eq`가 정의한 함수에 대해서 함수의 바디를 구현했지만, 상호 재귀 관점에서만 정의했습니다. `Eq`의 인스턴스 두개가 다르지 않다면 같은 것이고, 같지않다면 다를 것입니다. 이런 구현은 반드시 하지않아도 되지만 어떤 도움을 줄 수 있는지 보게 될 것 입니다. 

```haskell
data TrafficLight = Red | Yellow | Green
```

TrafficLight는 신호등의 상태를 정의합니다. TrafficLight는 클래스 인스턴스를 파생하지 않았습니다. `Eq`나 `Show`로 파생시킬수도 있지만, 여기서는 직접 어떤 인스턴스를 작성해보도록 하겠습니다. 

```haskell
instance Eq TrafficLight where
    Red == Red = True
    Green == Green = True
    Yellow == Yellow = True
    _ == _ = False
``` 

_instance_ 키워드를 사용해서 인스턴스로 작성하였습니다. _class_는 새로운 타입클래스를 정의하고, _instance_는 타입클래스의 타입 인스턴스를 만듭니다. `Eq`를 정의할때 `class Eq a where`로 작성하고 여기서 `a`는 나중에 인스턴스가 만들어질때 타입의 역할을 한다고 했습니다. 여기서는 `instance Eq TrafficLight where`로 작성하여 바로 인스턴스로 만들었기 때문에 좀 더 명확합니다. `a`를 실제 타입으로 변경하였습니다. 

_class_ 선언안에서 `==`은 `\=`와 그 반대의 관점에서 정의되었기 때문에, 인스턴스 선언안에 둘 중 하나를 겹쳐서 사용했습니다. 이것을 타입클래스의 **최소한의 완전한 선언**이라고 부릅니다(타입이 클래스처럼 동작할 수 있도록 하기위해 구현해야하는 최소한의 함수). `Eq`가 최소한의 완전한 선언을 수행하려면 `==` 또는 `\=`중 하나를 overwrite해야 합니다. `Eq`를 간단히 정의하면 아래와 같습니다.   

```haskell
class Eq a where
    (==) :: a -> a -> Bool
    (\=) :: a -> a -> Bool
```

이렇게 선언된 타입클래스의 인스턴스 타입을 만들때는 두 함수 모두 구현해야 합니다. 왜냐하면 하스켈은 두 함수가 어떻게 관련되어 있는지 알지못하기 때문입니다. 최소한의 완전한 선언은 `==`과 `\=` 모두가 될 것입니다.

이번에는 TrafficLight를 `Show`의 인스턴스로 만들어 보겠습니다. `Show`에 대한 최소한의 완전한 정의를 만족하기 위해서, 값을 문자열로 변환하는 `show` 함수를 구현해야 합니다. 

```haskell
instance Show TrafficLight where
    show Red = "Red light"
    show Yellow = "Yellow light"
    show Green = "Green light"
```








 



    

  

